(lambda m:(print(sum(sum(w)for w in m)),[print(''.join(' @'[e]for e in l))for l in m]))(__import__("functools").reduce(lambda m,s:(lambda m,a,q=(lambda m,r,n:m[:r]+[m[r][-n:]+m[r][:-n]]+m[r+1:]):(a[0]=='rect'and(lambda m,w,h:[[1]*w+m[i][w:]for i in range(h)]+m[h:])(m,int(a[1]),int(a[2]))or(a[1]=='row'and q(m,int(a[3]),int(a[5]))or(lambda m,c,n:[list(o)for o in zip(*q([list(o)for o in zip(*m)],c,n))])(m,int(a[2]),int(a[4])))))(m,s.split()),open('08.dat','rt').read().strip().replace('=',' ').replace('x',' ').split('\n'),6*[50*[0]]))
